(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();function g(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(e){let t;return e==null?"":(e<60*60?t=14:e<60*60*10?t=12:t=11,new Date(Math.floor(e)*1e3).toISOString().substring(t,19))}new Proxy({},{get(e,t){throw new Error(`Module "node:fs/promises" has been externalized for browser compatibility. Cannot access "node:fs/promises.${t}" in client code.  See https://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}});function f(e,t){let n="";if(typeof e!="object"?n="Not an object":(t.forEach(o=>{o in e||(n+=(n.length?", ":"")+o)}),n.length&&(n="Missing properties: "+n)),n.length)return new Error(n)}function p(e,t=!1){let n=f(e,["type","alternatives","speaker_label"]);if(n)n.message="Invalid AwsTranscriptItem: "+n.message;else{let o="";e.alternatives.length==0?o="Alternatives list is empty":e.alternatives[0].content?e.alternatives[0].content.length==0?o="Content property is empty":e.type=="punctuation"?t?o="Punctuation at the start of a sentence":(e.start_time!=null&&console.log(`WARNING: Punctuation has a start time: ${e.start_time}`),e.end_time!=null&&console.log(`WARNING: Punctuation has an end_time time: ${e.end_time}`),e.alternatives[0].confidence?parseFloat(e.alternatives[0].confidence)!=0&&console.log(`UNEXPECTED: Punctuation has non-zero confidence: ${e.alternatives[0].confidence}`):console.log("UNEXPECTED: Punctuation has no confidence property")):e.type=="pronunciation"?(e.start_time==null?o="Pronunciation has no start time":e.end_time==null&&(o="Pronunciation has no end time"),e.alternatives[0].confidence?parseFloat(e.alternatives[0].confidence)==0&&console.log("WARNING: Pronunciation has zero confidence: "):console.log("WARNING: Pronunciation has no confidence property")):o=`Unexpected item type: ${e.type}`:o="Content property is missing",o.length!=0&&(n=new Error(o))}return n}function v(e){let t;if(t=f(e,["results"]),t)return t.message="Invalid schema: "+t.message,t;if(t=f(e.results,["items"]),t)return t.message="Invalid schema of 'result': "+t.message,t;if(e.results.items.length==0)return Error("Transcript contains no words")}function y(e){let t;if(t=v(e),t)return t;const n=e.results.items,o=[];let i=[],r,s,l,c=n[0];if(t=p(c,!0),t)return t;let a=parseInt(c.speaker_label.substring(4)),d=0;do{if(s=c,l={content:"",end_time:0,start_time:0},r=a,d==n.length-1)a=-1;else{if(c=n[d+1],t=p(c),t)return t;a=parseInt(c.speaker_label.substring(4)),s.type=="punctuation"&&c.type=="punctuation"&&console.log("WARNING: Two punctuations in a row.")}l.content=s.alternatives[0].content,s.type=="pronunciation"?(l.confidence=s.alternatives[0].confidence?parseFloat(s.alternatives[0].confidence):.999,l.start_time=parseFloat(s.start_time),l.end_time=parseFloat(s.end_time)):(delete l.start_time,delete l.end_time),i.push(l),r!=a&&(o.push({speaker:r,words:i}),i=[]),d++}while(a!=-1);return o}function _(e){const t=[],n=e.lines;for(let o=0;o<n.length;o++){const i=n[o],r=i.words;let s="";for(let l=0;l<r.length;l++){const c=r[l];["um","uh","mhm"].includes(c.content)||(s+=(s.length>0&&c.start_time?" ":"")+c.content)}t.push({start_time:h(r[0].start_time),speaker:e.speakers[i.speaker],words:s})}return t}const u="ic";function P(e,t){let n=document.getElementById(u+e);n&&n.addEventListener("click",t)}function E(e){const t=document.getElementById(u+"-line");if(t){let n="";for(let o=0;o<e.length;o++){let i=e[o];n+="<p>"+g(i.start_time+" "+i.speaker+": "+i.words)+"</p>"}t.innerHTML=n}}async function m(e){const n=await(await window.fetch(e)).json();let o;if("accountId"in n){o={url:e,speakers:[],lines:[]};const i=y(n);if(i instanceof Error){console.log(i.message);return}o.lines=i,o.speakers=["Speaker 1","Speaker 2"]}else o=n;E(_(o))}const N=async e=>{if(e.type==="click"){const t=document.getElementById(u+"-transcript-url");t&&m(t.value)}};function b(){const e=window.location.search,n=new URLSearchParams(e).get("url"),o=document.getElementById(u+"-transcript-url");o&&n&&(o.value=n,m(n)),P("-load",N)}b();
